<Window x:Class="Umarejson.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Umarejson" 
        xmlns:csharplib="clr-namespace:Csharplib.winTitleBar;assembly=winTitleBar" 
        xmlns:svg="http://sharpvectors.codeplex.com/svgc/"
        mc:Ignorable="d"
        Title="JSON 编辑器" Height="661" Width="900"
        WindowStartupLocation="CenterScreen" FontFamily="Segoe UI" FontSize="16"
        Background="#FF1A1A1D" Foreground="White" WindowStyle="None" AllowsTransparency="True"
        >

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="vsResources.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Border BorderBrush="{Binding Background, ElementName=Debugtag}" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>



            <!-- 自定义标题栏 -->
            <csharplib:winTitleBar Title="{Binding Title, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" Icon="{Binding Icon, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/>



            <Grid Grid.Row="1">
                <Grid Margin="10,10,10,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="200px"/>
                    </Grid.ColumnDefinitions>

                    <!-- JSON 操作区 -->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- JSON 路径输入 -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                            <TextBlock Text="定位:" VerticalAlignment="Center"/>
                            <TextBox x:Name="PathTextBox" Width="300" VerticalAlignment="Center" Background="#FF333333"/>
                            <Button x:Name="NavigateButton" Content="导航" Padding="10,2" Click="NavigateButton_Click"/>
                        </StackPanel>

                        <Grid Grid.Row="1">
                            <Grid.RowDefinitions>
                                <!-- 上半部分的高度通过绑定动态调整 -->
                                <RowDefinition Height="{Binding TopRowHeight}" />
                                <!-- GridSplitter -->
                                <RowDefinition Height="Auto" />
                                <!-- 下半部分的高度通过绑定动态调整 -->
                                <RowDefinition Height="{Binding BottomRowHeight}" />
                            </Grid.RowDefinitions>

                            <!-- 树形视图显示 JSON 结构 -->
                            <TreeView x:Name="JsonTreeView" Grid.Row="0" Margin="5" SelectedItemChanged="JsonTreeView_SelectedItemChanged"
              KeyDown="Del_KeyDown">
                                <TreeView.Resources>
                                    <Style TargetType="{x:Type TreeViewItem}">
                                        <Setter Property="IsExpanded" Value="True"/>
                                        <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/>
                                        <Setter Property="ContextMenu">
                                            <Setter.Value>
                                                <ContextMenu>
                                                    <MenuItem Header="天成"/>
                                                </ContextMenu>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </TreeView.Resources>
                            </TreeView>

                            <!-- GridSplitter 修改为垂直调整 -->
                            <GridSplitter x:Name="textsplitter" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                  Height="2" Background="#424242" ShowsPreview="True" ResizeDirection="Rows"
                  DragDelta="GridSplitter_DragDelta"/>

                            <!-- JSON 原始数据显示 -->
                            <TextBox x:Name="JsonTextBox" Grid.Row="2" Margin="5" AcceptsReturn="True" 
             VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
             TextChanged="JsonTextBox_TextChanged"/>
                        </Grid>



                    </Grid>

                    <!-- JSON 功能区 -->
                    <Grid Grid.Column="1">
                        <StackPanel Orientation="Vertical">
                            <Label Content="操作点位" FontWeight="Bold" VerticalContentAlignment="Center"/>

                            <StackPanel Orientation="Horizontal">
                                <Label Content="类型:"/>
                                <TextBlock x:Name="选中类型" Text=""/>
                            </StackPanel>

                            <Border x:Name="更删功能框" BorderBrush="#3d3d3d" BorderThickness="1,1,1,1" Padding="5,5,5,5" Margin="0,5,0,0">

                                <StackPanel Orientation="Vertical">
                                    <Label Content="更改" FontWeight="Bold" VerticalContentAlignment="Center"/>

                                    <Grid x:Name="序号条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40px"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Content="序:" VerticalContentAlignment="Center"/>
                                        <TextBox x:Name="序号" Text="" IsEnabled="False" Grid.Column="1"/>
                                    </Grid>

                                    <Grid x:Name="键改条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40px"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Content="键:" VerticalContentAlignment="Center"/>
                                        <TextBox x:Name="键名" Text="" Grid.Column="1"
                                            KeyDown="Enter_KeyDown" Tag="EditButton_Click"/>
                                    </Grid>

                                    <Grid x:Name="值改条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40px"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Content="值:" VerticalContentAlignment="Center"/>
                                        <TextBox x:Name="值名" Text="" Grid.Column="1" KeyDown="Enter_KeyDown" Tag="EditButton_Click"/>
                                        <CheckBox x:Name="值字符串" Content="字符串" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="2" VerticalContentAlignment="Center"/>

                                    </Grid>

                                    <Grid x:Name="值类型改条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Content="值类型:"/>
                                        <Label x:Name="值类型" Grid.Column="1"/>
                                    </Grid>

                                    <StackPanel Orientation="Horizontal">
                                        <Button x:Name="EditButton" Content="更改" Click="EditButton_Click" Width="80"/>
                                        <Button x:Name="DeleteButton" Content="删除" Width="80" Click="DeleteButton_Click" HorizontalContentAlignment="Center"/>
                                    </StackPanel>

                                </StackPanel>
                            </Border>


                            <Border x:Name="添加功能框" BorderBrush="#3d3d3d" BorderThickness="1,1,1,1" Padding="5,5,5,5" Margin="0,5,0,0">
                                <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                    <Label Content="新增" FontWeight="Bold" VerticalContentAlignment="Center"/>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Content="种类:" VerticalContentAlignment="Center"/>
                                        <ComboBox x:Name="添加类型" VerticalAlignment="Top" SelectedIndex="0" 
                                            SelectionChanged="JsonTreeView_SelectedItemChanged" SelectedValuePath="Content" Grid.Column="1" IsReadOnly="True">
                                            <ComboBoxItem Content="数据"/>
                                            <ComboBoxItem Content="对象"/>
                                            <ComboBoxItem Content="数组"/>
                                        </ComboBox>
                                    </Grid>



                                    <Grid x:Name="添加序号条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40px"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Content="序:" VerticalContentAlignment="Center"/>
                                        <TextBox x:Name="添加序号" Text="" Grid.Column="1"/>
                                    </Grid>

                                    <Grid x:Name="添加键改条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40px"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Content="键:" VerticalContentAlignment="Center"/>
                                        <TextBox x:Name="添加键名" Text="" Grid.Column="1"
                                            KeyDown="Enter_KeyDown" Tag="AddButton_Click"/>
                                    </Grid>

                                    <Grid x:Name="添加值改条">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40px"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Content="值:" VerticalContentAlignment="Center"/>
                                        <TextBox x:Name="添加值名" Text="" Grid.Column="1" KeyDown="Enter_KeyDown" Tag="AddButton_Click"/>
                                        <CheckBox x:Name="添加值字符串" Content="字符串" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="2" IsChecked="True"/>

                                    </Grid>

                                    <Button x:Name="AddButton" Content="添加" Width="80" Click="AddButton_Click" HorizontalAlignment="Left"/>
                                </StackPanel>
                            </Border>

                            <Border x:Name="其他功能框" BorderBrush="#3d3d3d" BorderThickness="1,1,1,1" Padding="5,5,5,5"  Margin="0,5,0,0">

                                <UniformGrid>
                                    <Button x:Name="LoadButton" Content="加载" Width="80" Click="LoadButton_Click" VerticalAlignment="Center"/>
                                    <Button x:Name="RefreshButton" Content="刷新" Width="80" Click="RefreshButton_Click" VerticalAlignment="Center" Margin="0,2,2,2"/>
                                    <Button x:Name="SaveButton" Content="保存" Width="80" Click="SaveButton_Click" VerticalAlignment="Center"/>
                                    <Button x:Name="OpenButton" Content="打开" Width="80" Click="OpenButton_Click" VerticalAlignment="Center" Margin="0,2,2,2"/>

                                </UniformGrid>
                            </Border>


                        </StackPanel>
                    </Grid>
                </Grid>


            </Grid>
            <Label x:Name="Debugtag" Grid.Row="3" VerticalContentAlignment="Center" Content="就绪" Background="#FF007ACC"/>
        </Grid>
    </Border>
</Window>